
        import path from 'path';
        import { fileURLToPath } from 'url';
        import { createRequire as topLevelCreateRequire } from 'module';
        const require = topLevelCreateRequire(import.meta.url);
        const __filename = fileURLToPath(import.meta.url);
        const __dirname = path.dirname(__filename);
        
var X=(h=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(h,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):h)(function(h){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+h+'" is not supported')});import M from"chalk";import st from"concat-stream";import oe from"lodash";import{loadWASM as at}from"vscode-oniguruma";import ot from"yargs";import{promises as lt}from"fs";import ct from"os";import{hideBin as ht}from"yargs/helpers";var Z="blade-formatter";var ce="1.41.1";import it from"ignore";import $ from"chalk";import De from"find-config";import z from"fs";import rt from"glob";import v from"lodash";import I from"path";import g from"process";import Le from"util";var O=class extends Error{};import{sortClasses as ae}from"@shufo/tailwindcss-class-sorter";import qe from"aigle";import b from"detect-indent";import{sortAttributes as Be}from"html-attribute-sorter";import L from"js-beautify";import r from"lodash";import*as Ke from"vscode-textmate";import Ge from"xregexp";import x from"string-replace-async";function ke(h){return h.split(`
`)}function Fe(h){return h.trim().startsWith("*")}function Te(h){return h.length>1}function je(h){return` ${h}`}function he(h){let e=ke(h);if(!Te(e))return h;let t=!1;return e.map((i,s)=>{if(s===0||t)return i;if(!Fe(i))return t=!0,i;let a=i.trim();return je(a)}).join(`
`)}var Oe={defaultPrintWidth:120},Y=Oe;import J from"lodash";var k="@",P=["@alert","@pushonce","@push","@slot","@switch","@unless","@verbatim","@prependonce","@prepend","@once","@error","@empty","@guest","@isset","@permission","@permissions","@canany","@cannot","@can","@role","@hasrole","@hasanyrole","@hasallroles","@unlessrole","@hasexactroles","@if","@production","@env","@while","@auth","@forelse","@for","@foreach","@php","@component","@section","@customdirective"],pe=J.map(P,h=>h.substring(1)),R=["@endalert","@endpushonce","@endpush","@endslot","@endswitch","@endunless","@endverbatim","@show","@stop","@endprependonce","@endprepend","@endonce","@enderror","@append","@overwrite","@endempty","@endguest","@endisset","@endpermission","@endpermissions","@endcanany","@endcannot","@endcan","@endrole","@endhasrole","@endhasanyrole","@endhasallroles","@endunlessrole","@endhasexactroles","@endif","@endproduction","@endenv","@endwhile","@endauth","@endforelse","@endforeach","@endfor","@endphp","@endcomponent","@endsection","@endcustomdirective"],E=["@elseenv","@elseif","@elsecanany","@elsecannot","@elsecan","@else","@elsecustomdirective"],ee={"@section":2,"@push":2,"@prepend":2,"@slot":2},de=["@forelse","@if"],te=["@empty"],ue=["@default"],F=["@forelse","@if","@for","@foreach","@while","@sectionmissing","@case"],U=["@endforelse","@endif","@endforeach","@endfor","@endwhile","@break"],ne=["@button","@class","@include","@disabled","@checked","@json"],T=["@set","@json","@selected","@checked","@disabled","@php","@include","@includeif","@includewhen","@includeunless","@includefirst","@button","@class","@props","@aware"],me=["@if","@while","@case","@isset","@empty","@elseif","@component","@hassection","@unless"],V=["@hassection"],Q=["@charset","@color-profile","@counter-style","@font-face","@font-feature-values","@import","@keyframes","@media","@namespace","@page","@property","@supports"];function ge(h,e){return J.filter(h.tokens,t=>{let n=e.substring(t.startIndex,t.endIndex).trim();return J.includes(P,n)||J.includes(R,n)}).length>=2}var y="\\(((?:[^)(]+|\\((?:[^)(]+|\\((?:[^)(]+|\\((?:[^)(]+|\\([^)(]*\\))*\\))*\\))*\\))*)\\)?";import He from"lodash";function fe(h){let e=["@unless"];return He.replace(h,new RegExp(`(?<!@)(${e.join("|")})\\s*${y}`,"gi"),(t,n,i)=>`${n} (${i})`)}import S from"lodash";import We from"fs";import ze from"os";import ie from"chalk";import*as H from"prettier/standalone";import re from"@prettier/plugin-php/standalone";import Et from"detect-indent";import Ne from"string-replace-async";var f=h=>{let e={get(){return null}};return S.isUndefined(h)||S.isNull(h)?e:h};async function q(h){return new Promise((e,t)=>{We.readFile(h,(n,i)=>n?t(n):e(i))})}function W(h){return h?h.split(/\r\n|\n|\r/):""}var A=1e3,ye={noPhpSyntaxCheck:!1,printWidth:A,trailingCommaPHP:!0,phpVersion:"8.1",noSingleQuote:!1};async function D(h,e={}){var s;let t={...ye,...e},n=(s=e.adjustPrintWidthBy)!=null?s:0,i=e.useProjectPrintWidth?t.printWidth-n:A;try{return await H.format(h.replace(/\n$/,""),{parser:"php",printWidth:i,singleQuote:!t.noSingleQuote,phpVersion:t.phpVersion,trailingCommaPHP:t.trailingCommaPHP,plugins:[re]})}catch(a){if(t.noPhpSyntaxCheck===!1)throw a;return h}}async function C(h,e={}){let t={...ye,...e};try{return(await H.format(`<?php echo ${h} ?>`,{parser:"php",printWidth:t.printWidth,singleQuote:!t.noSingleQuote,phpVersion:t.phpVersion,trailingCommaPHP:t.trailingCommaPHP,plugins:[re]})).replace(/<\?php echo (.*)?\?>/gs,(n,i)=>i.trim().replace(/;\s*$/,""))}catch(n){if(t.noPhpSyntaxCheck===!1)throw n;return h}}async function _e(h){let e=`<?php tmp_func${h}; ?>`;try{let{ast:t}=await H.__debug.parse(e,{parser:"php",phpVersion:"8.1",plugins:[re]});return t.children[0].expression.arguments.length||0}catch{return 0}}function we(h){return Promise.all(S.map(h,async e=>{process.stdout.write(`path: ${ie.bold(e.path)}:${e.line}
`),process.stdout.write(ie.red(`--${e.original}
`)),process.stdout.write(ie.green(`++${e.formatted}
`))}))}function be(h,e,t){let n=S.map(e,(i,s)=>S.isEmpty(i)||i===t[s]?null:{path:h,line:s+1,original:i,formatted:t[s]});return S.without(n,null)}async function Me(h,e){let t=S.without(P,"@switch","@forelse","@php").join("|"),n=new RegExp(`(?!\\/\\*.*?\\*\\/)(${t})(\\s*?)${y}`,"gmi");return new Promise(i=>i(h)).then(i=>Ne(i,n,async(s,a,l,o)=>(await D(`<?php ${a.substr("1")}${l}(${o}) ?>`,e)).replace(/<\?php\s(.*?)(\s*?)\((.*?)\);*\s\?>\n/gs,(c,d,p,u)=>`@${d.trim()}${p}(${u.trim()})`).replace(/([\n\s]*)->([\n\s]*)/gs,"->").replace(/,\)$/,")").replace(/(?:\n\s*)* as(?= (?:&{0,1}\$[\w]+|list|\[\$[\w]+))/g," as"))).then(i=>D(i,e))}async function ve(h,e){return Me(h,e)}function Pe(h){let e=S.without(F,"@case"),t=S.without(U,"@break");return new Promise(n=>n(h)).then(n=>{let i=new RegExp(`(${e.join("|")})([\\s]*?)${y}`,"gis");return S.replace(n,i,(s,a,l,o)=>`<beautifyTag start="${a}${l}" exp="^^^${S.escape(o)}^^^">`)}).then(n=>{let i=new RegExp(`(?!end=".*)(${t.join("|")})(?!.*")`,"gi");return S.replace(n,i,(s,a)=>`</beautifyTag end="${a}">`)})}function $e(h){return new Promise(e=>e(h)).then(e=>S.replace(e,/<beautifyTag.*?start="(.*?)".*?exp=".*?\^\^\^(.*?)\^\^\^.*?"\s*>/gs,(t,n,i)=>`${n}(${S.unescape(i)})`)).then(e=>S.replace(e,/<\/beautifyTag.*?end="(.*?)"\s*>/gs,(t,n)=>`${n}`))}var Xe=["/\\*\\* phptag_start \\*\\*/","/\\*\\* end_phptag \\*\\*/","/\\*escaped\\*/","__BLADE__;","/\\* blade_comment_start \\*/","/\\* blade_comment_end \\*/","/\\*\\*\\*script_placeholder\\*\\*\\*/","blade___non_native_scripts_","blade___scripts_","blade___html_tags_","beautifyTag","@customdirective","@elsecustomdirective","@endcustomdirective","x-slot --___\\d+___--","___attrs_+\\d+___"];function xe(h){if(new RegExp(Xe.join("|")).test(h))throw new Error(["Can't format blade: something goes wrong.","Please check if template is too complicated or not. Or simplify template might solves issue."].join(`
`));return h}function se(h){return h.replace(/\$/g,"$$$$")}function Se(h){switch(h){case"LF":return`
`;case"CRLF":return`\r
`;default:return ze.EOL}}import{promises as Je}from"fs";import Ue from"lodash";import*as K from"vscode-oniguruma";import Ve from"path";var G=class{constructor(e,t){return(async()=>{var n;return this.vsctm=(n=e.default)!=null?n:e,this.oniguruma=t||(K==null?void 0:K.default)||K,await this.loadWasm(),this})()}async loadWasm(){var t;let e=await Je.readFile(X.resolve("vscode-oniguruma/release/onig.wasm"));if(await((t=this.oniguruma)==null?void 0:t.loadWASM(e.buffer)),!this.initCalled){try{this.oniguruma.loadWASM(e.buffer)}catch{this.initCalled=!0}this.initCalled=!0}}createRegistry(){return this.registry=new this.vsctm.Registry({loadGrammar:e=>e==="text.html.php.blade"?q(Ve.resolve(__dirname,"../syntaxes/blade.tmLanguage.json")).then(t=>this.vsctm.parseRawGrammar(t.toString(),"./blade.tmLanguage.json")):null,onigLib:Promise.resolve({createOnigScanner:e=>new this.oniguruma.OnigScanner(e),createOnigString:e=>new this.oniguruma.OnigString(e)})}),this.registry}tokenizeLines(e,t){return Ue.map(e,n=>{var i;return t.tokenizeLine(n,(i=this.vsctm)==null?void 0:i.INITIAL)})}};var j=class{constructor(e){this.options={noPhpSyntaxCheck:!1,trailingCommaPHP:!e.noTrailingCommaPhp,printWidth:e.wrapLineLength||Y.defaultPrintWidth,...e},this.vsctm=f(this.options).vsctm||Ke,this.oniguruma=f(this.options).oniguruma,this.indentCharacter=f(this.options).useTabs?"	":" ",this.indentSize=f(this.options).indentSize||4,this.wrapLineLength=f(this.options).wrapLineLength||Y.defaultPrintWidth,this.wrapAttributes=f(this.options).wrapAttributes||"auto",this.currentIndentLevel=0,this.shouldBeIndent=!1,this.isInsideCommentBlock=!1,this.stack=[],this.ignoredLines=[],this.curlyBracesWithJSs=[],this.rawBlocks=[],this.rawPhpTags=[],this.inlineDirectives=[],this.conditions=[],this.inlinePhpDirectives=[],this.rawPropsBlocks=[],this.bladeDirectives=[],this.bladeDirectivesInStyle=[],this.bladeComments=[],this.phpComments=[],this.bladeBraces=[],this.rawBladeBraces=[],this.nonnativeScripts=[],this.scripts=[],this.htmlAttributes=[],this.xData=[],this.xInit=[],this.htmlTags=[],this.templatingStrings=[],this.stringLiteralInPhp=[],this.shorthandBindings=[],this.componentAttributes=[],this.customDirectives=[],this.directivesInScript=[],this.unbalancedDirectives=[],this.escapedBladeDirectives=[],this.xSlot=[],this.result=[],this.diffs=[],this.defaultPhpFormatOption={noPhpSyntaxCheck:this.options.noPhpSyntaxCheck,printWidth:this.wrapLineLength},this.endOfLine=Se(f(this.options).endOfLine)}formatContent(e){return new Promise(t=>t(e)).then(t=>this.preserveIgnoredLines(t)).then(t=>this.preserveNonnativeScripts(t)).then(t=>this.preserveCurlyBraceForJS(t)).then(t=>this.preserveRawPhpTags(t)).then(t=>this.preserveEscapedBladeDirective(t)).then(t=>ve(t,this.options)).then(t=>this.preserveBladeComment(t)).then(t=>this.preserveBladeBrace(t)).then(t=>this.preserveRawBladeBrace(t)).then(t=>this.preserveConditions(t)).then(t=>this.preservePropsBlock(t)).then(t=>this.preserveInlinePhpDirective(t)).then(t=>this.preserveInlineDirective(t)).then(t=>this.preserveBladeDirectivesInScripts(t)).then(t=>this.preserveBladeDirectivesInStyles(t)).then(t=>this.preserveCustomDirective(t)).then(t=>this.preserveUnbalancedDirective(t)).then(t=>this.breakLineBeforeAndAfterDirective(t)).then(async t=>(this.bladeDirectives=await this.formatPreservedBladeDirectives(this.bladeDirectives),t)).then(t=>this.preserveScripts(t)).then(t=>this.sortTailwindcssClasses(t)).then(t=>this.formatXInit(t)).then(t=>this.formatXData(t)).then(t=>this.preservePhpBlock(t)).then(t=>this.sortHtmlAttributes(t)).then(t=>this.preserveHtmlAttributes(t)).then(t=>this.preserveComponentAttribute(t)).then(t=>this.preserveShorthandBinding(t)).then(t=>this.preserveXslot(t)).then(t=>this.preserveHtmlTags(t)).then(t=>this.formatAsHtml(t)).then(t=>this.formatAsBlade(t)).then(t=>this.restoreHtmlTags(t)).then(t=>this.restoreXslot(t)).then(t=>this.restoreShorthandBinding(t)).then(t=>this.restoreComponentAttribute(t)).then(t=>this.restoreHtmlAttributes(t)).then(t=>this.restorePhpBlock(t)).then(t=>this.restoreXData(t)).then(t=>this.restoreXInit(t)).then(t=>this.restoreScripts(t)).then(t=>this.restoreUnbalancedDirective(t)).then(t=>this.restoreCustomDirective(t)).then(t=>this.restoreBladeDirectivesInStyles(t)).then(t=>this.restoreBladeDirectivesInScripts(t)).then(t=>this.restoreInlineDirective(t)).then(t=>this.restoreInlinePhpDirective(t)).then(t=>this.restoreConditions(t)).then(t=>this.restoreRawBladeBrace(t)).then(t=>this.restoreBladeBrace(t)).then(t=>this.restoreBladeComment(t)).then(t=>this.restoreEscapedBladeDirective(t)).then(t=>this.restoreRawPhpTags(t)).then(t=>this.restoreCurlyBraceForJS(t)).then(t=>this.restoreNonnativeScripts(t)).then(t=>this.restoreIgnoredLines(t)).then(t=>fe(t)).then(t=>xe(t))}formatAsHtml(e){let t={indent_size:f(this.options).indentSize||4,wrap_line_length:f(this.options).wrapLineLength||120,wrap_attributes:f(this.options).wrapAttributes||"auto",wrap_attributes_min_attrs:f(this.options).wrapAttributesMinAttrs,indent_inner_html:f(this.options).indentInnerHtml||!1,end_with_newline:f(this.options).endWithNewline||!0,max_preserve_newlines:f(this.options).noMultipleEmptyLines?1:void 0,extra_liners:f(this.options).extraLiners,css:{end_with_newline:!1},eol:this.endOfLine},n=new Promise(i=>i(e)).then(i=>Pe(i)).then(i=>L.html_beautify(i,t)).then(i=>$e(i));return Promise.resolve(n)}async sortTailwindcssClasses(e){return this.options.sortTailwindcssClasses?r.replace(e,/(?<=\s+(?!:)class\s*=\s*([\"\']))(.*?)(?=\1)/gis,(t,n,i)=>{if(r.isEmpty(i))return i;if(this.options.tailwindcssConfigPath){let s={tailwindConfigPath:this.options.tailwindcssConfigPath};return ae(i,s)}if(this.options.tailwindcssConfig){let s={tailwindConfig:this.options.tailwindcssConfig};return ae(i,s)}return ae(i)}):e}async preserveIgnoredLines(e){return r.chain(e).replace(/(^(?<!.+)^{{--\s*blade-formatter-disable\s*--}}.*?)([\r\n]*)$(?![\r\n])/gis,(t,n,i)=>this.storeIgnoredLines(`${n}${i.replace(/^\n/,"")}`)).replace(/(?:({{--\s*?blade-formatter-disable\s*?--}}|<!--\s*?prettier-ignore-start\s*?-->|{{--\s*?prettier-ignore-start\s*?--}})).*?(?:({{--\s*?blade-formatter-enable\s*?--}}|<!--\s*?prettier-ignore-end\s*?-->|{{--\s*?prettier-ignore-end\s*?--}}))/gis,t=>this.storeIgnoredLines(t)).replace(/(?:{{--\s*?blade-formatter-disable-next-line\s*?--}}|{{--\s*?prettier-ignore\s*?--}}|<!--\s*?prettier-ignore\s*?-->)[\r\n]+[^\r\n]+/gis,t=>this.storeIgnoredLines(t)).value()}async preserveCurlyBraceForJS(e){return r.replace(e,/@{{(.*?)}}/gs,(t,n)=>this.storeCurlyBraceForJS(n))}async preservePhpBlock(e){return this.preserveRawPhpBlock(e)}async preservePropsBlock(e){return r.replace(e,/@props\(((?:[^\\(\\)]|\([^\\(\\)]*\))*)\)/gs,(t,n)=>this.storeRawPropsBlock(n))}async preserveRawPhpBlock(e){return r.replace(e,/(?<!@)@php(.*?)@endphp/gs,(t,n)=>this.storeRawBlock(n))}async preserveHtmlTags(e){let t=["textarea","pre"];return r.replace(e,new RegExp(`<(${t.join("|")})\\s{0,1}.*?>.*?<\\/(${t.join("|")})>`,"gis"),n=>this.storeHtmlTag(n))}preserveCustomDirective(e){let t=[...r.without(P,"@unless"),...R,...E,"@unless\\(.*?\\)"].join("|"),n=r.chain([...r.without(P,"@unless","@for"),...R,...E,...T,...r.without(F,"@for"),"@unless[a-z]*\\(.*?\\)","@for\\(.*?\\)",...V,...Q]).uniq().join("|").value(),i=new RegExp(`(?!(${n}))(@([a-zA-Z1-9_\\-]+))(?!.*?@end\\3)${y}.*?(?<!@end\\5)`,"gis"),s=new RegExp(`(?!(${t}))(@(unless)*([a-zA-Z1-9_\\-]+))(?!.*?\\2)(\\s|\\(.*?\\))+(.*?)(@end\\4)`,"gis"),a;return a=r.replace(e,i,l=>this.storeInlineCustomDirective(l)),a=r.replace(a,s,(l,o,c,d,p,u,m,w)=>{if(P.includes(c))return l;let _=l;return _=r.replace(_,new RegExp(`${c}(${y})*`,"gim"),B=>this.storeBeginCustomDirective(B)),_=r.replace(_,w,this.storeEndCustomDirective(w)),_=r.replace(_,new RegExp(`@else${p}(${y})*`,"gim"),B=>this.storeElseCustomDirective(B)),_}),s.test(a)&&(a=this.preserveCustomDirective(a)),a}preserveInlineDirective(e){let t=new RegExp(`(<[\\w\\-\\_]+?[^>]*?)${k}(${pe.join("|")})(\\s*?)?(\\([^)]*?\\))?((?:(?!@end\\2).)+)(@end\\2|@endif)(.*?/*>)`,"gims"),n=r.replace(e,t,(i,s,a,l,o,c,d,p)=>l===void 0&&o===void 0?`${s}${this.storeInlineDirective(`${k}${a.trim()}${c.trim()} ${d.trim()}`)}${p}`:l===void 0?`${s}${this.storeInlineDirective(`${k}${a.trim()}${o.trim()}${c}${d.trim()}`)}${p}`:o===void 0?`${s}${this.storeInlineDirective(`${k}${a.trim()}${l}${c.trim()} ${d.trim()}`)}${p}`:`${s}${this.storeInlineDirective(`${k}${a.trim()}${l}${o.trim()} ${c.trim()} ${d.trim()}`)}${p}`);return t.test(n)?this.preserveInlineDirective(n):n}async preserveInlinePhpDirective(e){return r.replace(e,new RegExp(`(?!\\/\\*.*?\\*\\/)(${T.join("|")})(\\s*?)${y}`,"gmsi"),t=>this.storeInlinePhpDirective(t))}preserveBladeDirectivesInScripts(e){return r.replace(e,/(?<=<script[^>]*?(?<!=)>)(.*?)(?=<\/script>)/gis,t=>{let n=[...P,...T];if(new RegExp(n.join("|"),"gmi").test(t)===!1)return/^[\s\n]+$/.test(t)?t.trim():t;let i=T.join("|"),s=new RegExp(`(?!\\/\\*.*?\\*\\/)(${i})(\\s*?)${y}`,"gmi"),a=r.chain(R).without("@endphp"),l=t;return l=r.replace(l,s,o=>this.storeBladeDirective(C(o,{...this.options,printWidth:A}))),l=r.replace(l,new RegExp(`(${P.join("|")})\\s*?${y}`,"gis"),o=>`if ( /*${this.storeBladeDirectiveInScript(o)}*/ ) {`),l=r.replace(l,new RegExp(`(${[...E,...te].join("|")})(?!\\w+?\\s*?\\(.*?\\))`,"gis"),o=>`/***script_placeholder***/} /* ${this.storeBladeDirectiveInScript(o)} */ {`),l=r.replace(l,new RegExp(`(${a.join("|")})`,"gis"),o=>`/***script_placeholder***/} /*${this.storeBladeDirectiveInScript(o)}*/`),l=r.replace(l,/(?<!@)@php(.*?)@endphp/gis,(o,c)=>this.storeRawBlock(c)),l=this.preserveCustomDirectiveInScript(l),l})}preserveBladeDirectivesInStyles(e){return r.replace(e,/(?<=<style[^>]*?(?<!=)>)(.*?)(?=<\/style>)/gis,t=>{let n=t,i=new RegExp(`(?!${["@end","@else",...Q].join("|")})@(\\w+)\\s*?(?![^\\1]*@end\\1)${y}`,"gmi");n=r.replace(n,i,c=>`${this.storeBladeDirectiveInStyle(c)} {/* inline_directive */}`);let s=new RegExp(`(?!${["@end","@else",...Q].join("|")})@(\\w+)\\s*?(${y})`,"gmi");n=r.replace(n,s,c=>`${this.storeBladeDirectiveInStyle(c)} { /*start*/`);let a=new RegExp(`(${P.join("|")})\\s*?(${y})`,"gmi");n=r.replace(n,a,c=>`${this.storeBladeDirectiveInStyle(c)} { /*start*/`);let l=new RegExp(`(${["@else\\w+",...E].join("|")})\\s*?(${y})?`,"gmi");n=r.replace(n,l,c=>`} ${this.storeBladeDirectiveInStyle(c)} { /*else*/`);let o=new RegExp(`${["@end\\w+",...R].join("|")}`,"gmi");return n=r.replace(n,o,c=>`} /* ${this.storeBladeDirectiveInStyle(c)} */`),n})}preserveCustomDirectiveInScript(e){let t=[...r.without(P,"@unless"),...R,...E,"@unless\\(.*?\\)"].join("|"),n=[...r.without(P,"@unless"),...R,...E,...T,...F,"@unless[a-z]*\\(.*?\\)",...V].join("|"),i=new RegExp(`(?!(${n}))(@([a-zA-Z1-9_\\-]+))(?!.*?@end\\3)${y}.*?(?<!@end\\5)`,"gis"),s=new RegExp(`(?!(${t}))(@(unless)*([a-zA-Z1-9_\\-]+))(?!.*?\\2)(\\s|\\(.*?\\))+(.*?)(@end\\4)`,"gis"),a;return a=r.replace(e,i,l=>this.storeInlineCustomDirective(l)),a=r.replace(a,s,(l,o,c,d,p,u,m,w)=>{if(P.includes(c))return l;let _=l;return _=r.replace(_,new RegExp(`${c}(${y})*`,"gim"),B=>`if ( /*${this.storeBladeDirectiveInScript(B)}*/ ) {`),_=r.replace(_,new RegExp(`@else${p}(${y})*`,"gim"),B=>`/***script_placeholder***/} /* ${this.storeBladeDirectiveInScript(B)} */ {`),_=r.replace(_,w,B=>`/***script_placeholder***/} /*${this.storeBladeDirectiveInScript(B)}*/`),_}),s.test(a)&&(a=this.preserveCustomDirectiveInScript(a)),a}breakLineBeforeAndAfterDirective(e){e=r.replace(e,new RegExp(`(?<=<.*?(?<!=)>)(${r.without(P,"@php").join("|")})(\\s*)${y}.*?(?=<.*?>)`,"gmis"),s=>`
${s.trim()}
`),e=r.replace(e,new RegExp(`(?<=<.*?(?<!=)>).*?(${r.without(R,"@endphp").join("|")})(?=<.*?>)`,"gmis"),s=>`
${s.trim()}
`);let t=["@case",...E];e=r.replace(e,new RegExp(`(\\s*?)(${t.join("|")})(\\s*?)${y}(\\s*)`,"gmi"),s=>`
${s.trim()}
`),e=r.replace(e,new RegExp(`\\s*?(?!(${r.without(E,"@else").join("|")}))@else\\s+`,"gim"),s=>`
${s.trim()}
`),e=r.replace(e,/@case\S*?\s*?@case/gim,s=>`${s.replace(`
`,"")}`);let n=["@break"];r.forEach(n,s=>{e=r.replace(e,new RegExp(`(\\s*?)${s}\\s+`,"gmi"),a=>`
${a.trim()}

`)}),r.forEach(["@default"],s=>{e=r.replace(e,new RegExp(`(\\s*?)${s}\\s*`,"gmi"),a=>`

${a.trim()}
`)});let i=r.chain(P).map(s=>r.replace(s,/@/,"")).value();return r.forEach(i,s=>{try{let a=Ge.matchRecursive(e,`\\@${s}`,`\\@end${s}`,"gmi",{valueNames:[null,"left","match","right"]});if(r.isEmpty(a))return;for(let l of a)if(l.name==="match"){new RegExp(P.join("|")).test(l.value)&&(e=r.replace(e,l.value,this.breakLineBeforeAndAfterDirective(se(l.value))));let o=new RegExp(`^(\\s*?)${y}(.*)`,"gmis"),c=r.replace(`${l.value}`,o,(d,p,u,m)=>m.trim()===""?`${p}(${u.trim()})
${m.trim()}`:`${p}(${u.trim()})
${m.trim()}
`);e=r.replace(e,l.value,se(c))}}catch{}}),e}async preserveEscapedBladeDirective(e){return r.replace(e,/@@\w*/gim,t=>this.storeEscapedBladeDirective(t))}async preserveXslot(e){return r.replace(e,/(?<=<\/?)(x-slot:[\w_\\-]+)(?=(?:[^>]*?[^?])?>)/gm,t=>this.storeXslot(t))}async preserveBladeComment(e){return r.replace(e,/\{\{--(.*?)--\}\}/gs,t=>this.storeBladeComment(t))}preservePhpComment(e){return r.replace(e,/\/\*(?:[^*]|[\r\n]|(?:\*+(?:[^*\/]|[\r\n])))*\*+\//gi,t=>this.storePhpComment(t))}async preserveBladeBrace(e){return r.replace(e,/\{\{(.*?)\}\}/gs,(t,n)=>n===""?this.storeBladeBrace(n,n.length):/\S/.test(n)?this.storeBladeBrace(n.trim(),n.trim().length):this.storeBladeBrace(" ",1))}async preserveRawBladeBrace(e){return r.replace(e,/\{!!(.*?)!!\}/gs,(t,n)=>n===""?this.storeRawBladeBrace(n):/\S/.test(n)?this.storeRawBladeBrace(n.trim()):this.storeRawBladeBrace(" "))}async preserveConditions(e){let t=new RegExp(`(${me.join("|")})(\\s*?)${y}`,"gi");return r.replace(e,t,(n,i,s,a)=>`${i}${s}(${this.storeConditions(a)})`)}preserveUnbalancedDirective(e){let t=new RegExp(`((${V.join("|")})(?!.*?\\2)(?:\\s|\\(.*?\\)))+(?=.*?@endif)`,"gis"),n=r.replace(e,t,(i,s)=>`${this.storeUnbalancedDirective(s)}`);return t.test(n)&&(n=this.preserveUnbalancedDirective(n)),n}async preserveRawPhpTags(e){return r.replace(e,/<\?php(.*?)\?>/gms,t=>this.storeRawPhpTags(t))}async preserveNonnativeScripts(e){return r.replace(e,/<script[^>]*?type=(["'])(?!(text\/javascript|module))[^\1]*?\1[^>]*?>.*?<\/script>/gis,t=>this.storeNonnativeScripts(t))}async preserveScripts(e){return r.replace(e,/<script.*?>.*?<\/script>/gis,t=>this.storeScripts(t))}async preserveHtmlAttributes(e){return r.replace(e,/(?<=<[\w\-\.\:\_]+[^]*\s)(?!x-bind)([^\s\:][^\s\'\"]+\s*=\s*(["'])(?<!\\)[^\2]*?(?<!\\)\2)(?=[^]*(?<!=)\/?>)/gms,t=>`${this.storeHtmlAttribute(t)}`)}async sortHtmlAttributes(e){var n;let t=(n=this.options.sortHtmlAttributes)!=null?n:"none";if(!r.isEmpty(t)&&t!=="none"){let i=this.options.customHtmlAttributesOrder;if(r.isArray(i))return Be(e,{order:t,customRegexes:i});let s=r.chain(i).split(",").map(r.trim).value();return Be(e,{order:t,customRegexes:s})}return e}async preserveShorthandBinding(e){return r.replace(e,/(?<=<(?!livewire:)[^<]*?(\s|x-bind)):{1}(?<!=>)[\w\-_.]*?=(["'])(?!=>)[^\2]*?\2(?=[^>]*?\/*?>)/gim,t=>`${this.storeShorthandBinding(t)}`)}async preserveComponentAttribute(e){return r.replace(e,/(?<=<(x-|livewire:)[^<]*?\s):{1,2}(?<!=>)[\w\-_.]*?=(["'])(?!=>)[^\2]*?\2(?=[^>]*?\/*?>)/gim,t=>`${this.storeComponentAttribute(t)}`)}async formatXData(e){return r.replace(e,/(\s*)x-data="(.*?)"(\s*)/gs,(t,n,i,s)=>`${n}x-data="${this.storeXData(i)}"${s}`)}async formatXInit(e){return r.replace(e,/(\s*)x-init="(.*?)"(\s*)/gs,(t,n,i,s)=>`${n}x-init="${this.storeXInit(i)}"${s}`)}preserveStringLiteralInPhp(e){return r.replace(e,/(\"([^\\]|\\.)*?\"|\'([^\\]|\\.)*?\')/gm,t=>`${this.storeStringLiteralInPhp(t)}`)}storeIgnoredLines(e){return this.getIgnoredLinePlaceholder(this.ignoredLines.push(e)-1)}storeCurlyBraceForJS(e){return this.getCurlyBraceForJSPlaceholder(this.curlyBracesWithJSs.push(e)-1)}storeRawBlock(e){return this.getRawPlaceholder(this.rawBlocks.push(e)-1)}storeInlineDirective(e){return this.getInlinePlaceholder(this.inlineDirectives.push(e)-1,e.length)}storeConditions(e){return this.getConditionPlaceholder(this.conditions.push(e)-1)}storeInlinePhpDirective(e){return this.getInlinePhpPlaceholder(this.inlinePhpDirectives.push(e)-1)}storeRawPropsBlock(e){return this.getRawPropsPlaceholder(this.rawPropsBlocks.push(e)-1)}storeBladeDirective(e){return this.getBladeDirectivePlaceholder(this.bladeDirectives.push(e)-1)}storeBladeDirectiveInStyle(e){return this.getBladeDirectiveInStylePlaceholder((this.bladeDirectivesInStyle.push(e)-1).toString())}storeEscapedBladeDirective(e){return this.getEscapedBladeDirectivePlaceholder((this.escapedBladeDirectives.push(e)-1).toString())}storeXslot(e){return this.getXslotPlaceholder((this.xSlot.push(e)-1).toString())}storeBladeComment(e){return this.getBladeCommentPlaceholder(this.bladeComments.push(e)-1)}storePhpComment(e){return this.getPhpCommentPlaceholder((this.phpComments.push(e)-1).toString())}storeHtmlTag(e){return this.getHtmlTagPlaceholder((this.htmlTags.push(e)-1).toString())}storeInlineCustomDirective(e){return this.getInlineCustomDirectivePlaceholder((this.customDirectives.push(e)-1).toString())}storeBeginCustomDirective(e){return this.getBeginCustomDirectivePlaceholder((this.customDirectives.push(e)-1).toString())}storeElseCustomDirective(e){return this.getElseCustomDirectivePlaceholder((this.customDirectives.push(e)-1).toString())}storeEndCustomDirective(e){return this.getEndCustomDirectivePlaceholder((this.customDirectives.push(e)-1).toString())}storeUnbalancedDirective(e){return this.getUnbalancedDirectivePlaceholder((this.unbalancedDirectives.push(e)-1).toString())}storeBladeBrace(e,t){let n=this.bladeBraces.push(e)-1,i="{{  }}";return this.getBladeBracePlaceholder(n,t+i.length)}storeRawBladeBrace(e){let t=this.rawBladeBraces.push(e)-1;return this.getRawBladeBracePlaceholder(t)}storeRawPhpTags(e){let t=this.rawPhpTags.push(e)-1;return this.getRawPhpTagPlaceholder(t)}storeNonnativeScripts(e){let t=this.nonnativeScripts.push(e)-1;return this.getNonnativeScriptPlaceholder(t.toString())}storeScripts(e){let t=this.scripts.push(e)-1;return this.getScriptPlaceholder(t)}storeHtmlAttribute(e){let t=this.htmlAttributes.push(e)-1;return e.length>0?this.getHtmlAttributePlaceholder(t.toString(),e.length):this.getHtmlAttributePlaceholder(t.toString(),0)}storeShorthandBinding(e){let t=this.shorthandBindings.push(e)-1;return this.getShorthandBindingPlaceholder(t.toString(),e.length)}storeComponentAttribute(e){let t=this.componentAttributes.push(e)-1;return this.getComponentAttributePlaceholder(t.toString())}storeXData(e){let t=this.xData.push(e)-1;return this.getXDataPlaceholder(t)}storeXInit(e){let t=this.xInit.push(e)-1;return this.getXInitPlaceholder(t)}storeTemplatingString(e){let t=this.templatingStrings.push(e)-1;return this.getTemplatingStringPlaceholder(t)}storeStringLiteralInPhp(e){let t=this.stringLiteralInPhp.push(e)-1;return this.getStringLiteralInPhpPlaceholder(t)}storeBladeDirectiveInScript(e){return this.getBladeDirectiveInScriptPlaceholder((this.directivesInScript.push(e)-1).toString())}getIgnoredLinePlaceholder(e){return r.replace("___ignored_line_#___","#",e)}getCurlyBraceForJSPlaceholder(e){return r.replace("___js_curly_brace_#___","#",e)}getRawPlaceholder(e){return r.replace("___raw_block_#___","#",e)}getInlinePlaceholder(e,t=0){if(t>0){let i=t-"___inline_directive_#___".length;return r.replace(`___inline_directive_${r.repeat("_",i>0?i:0)}#___`,"#",e)}return r.replace("___inline_directive_+?#___","#",e)}getConditionPlaceholder(e){return r.replace("___directive_condition_#___","#",e)}getInlinePhpPlaceholder(e){return r.replace("___inline_php_directive_#___","#",e)}getRawPropsPlaceholder(e){return r.replace("@__raw_props_block_#__@","#",e)}getBladeDirectivePlaceholder(e){return r.replace("___blade_directive_#___","#",e)}getBladeDirectiveInStylePlaceholder(e){return r.replace(".___blade_directive_in_style_#__","#",e)}getEscapedBladeDirectivePlaceholder(e){return r.replace("___escaped_directive_#___","#",e)}getXslotPlaceholder(e){return r.replace("x-slot --___#___--","#",e)}getBladeCommentPlaceholder(e){return r.replace("___blade_comment_#___","#",e)}getPhpCommentPlaceholder(e){return r.replace("___php_comment_#___","#",e)}getBladeBracePlaceholder(e,t=0){if(t>0){let i=t-"___blade_brace_#___".length;return r.replace(`___blade_brace_${r.repeat("_",i>0?i:0)}#___`,"#",e)}return r.replace("___blade_brace_+?#___","#",e)}getRawBladeBracePlaceholder(e){return r.replace("___raw_blade_brace_#___","#",e)}getRawPhpTagPlaceholder(e){return r.replace("___raw_php_tag_#___","#",e)}getNonnativeScriptPlaceholder(e){return r.replace("<blade___non_native_scripts_#___ />","#",e)}getScriptPlaceholder(e){return r.replace("<blade___scripts_#___ />","#",e)}getHtmlTagPlaceholder(e){return r.replace("<blade___html_tags_#___ />","#",e)}getInlineCustomDirectivePlaceholder(e){return r.replace("___inline_cd_#___","#",e)}getBeginCustomDirectivePlaceholder(e){return r.replace("@customdirective(___#___)","#",e)}getElseCustomDirectivePlaceholder(e){return r.replace("@else(___#___)","#",e)}getEndCustomDirectivePlaceholder(e){return r.replace("@endcustomdirective(___#___)","#",e)}getUnbalancedDirectivePlaceholder(e){return r.replace("@if (unbalanced___#___)","#",e)}getHtmlAttributePlaceholder(e,t){if(t&&t>0){let i=t-"___attrs_#___".length;return r.replace(`___attrs${r.repeat("_",i>0?i:1)}#___`,"#",e)}return r.isNull(t)?r.replace("___attrs_#___","#",e):r.replace("___attrs_+?#___","#",e)}getShorthandBindingPlaceholder(e,t=0){if(t&&t>0){let i=t-"___short_binding_#___".length;return r.replace(`___short_binding_${r.repeat("_",i>0?i:1)}#___`,"#",e)}return r.replace("___short_binding_+?#___","#",e)}getComponentAttributePlaceholder(e){return r.replace("___attribute_#___","#",e)}getXInitPlaceholder(e){return r.replace("___x_init_#___","#",e)}getPlaceholder(e,t,n=null){if(n&&n>0){let i=`___${e}_#___`,s=n-i.length;return r.replace(`___${e}${r.repeat("_",s>0?s:1)}#___`,"#",t)}return r.isNull(n)?r.replace(`___${e}_#___`,"#",t):r.replace(`s___${e}_+?#___`,"#",t)}getXDataPlaceholder(e){return r.replace("___x_data_#___","#",e)}getTemplatingStringPlaceholder(e){return r.replace("___templating_str_#___","#",e)}getStringLiteralInPhpPlaceholder(e){return r.replace("'___php_content_#___'","#",e)}getBladeDirectiveInScriptPlaceholder(e){return r.replace("___directives_script_#___","#",e)}restoreIgnoredLines(e){return r.replace(e,new RegExp(`${this.getIgnoredLinePlaceholder("(\\d+)")}`,"gm"),(t,n)=>this.ignoredLines[n])}restoreCurlyBraceForJS(e){return r.replace(e,new RegExp(`${this.getCurlyBraceForJSPlaceholder("(\\d+)")}`,"gm"),(t,n)=>`@{{ ${L.js_beautify(this.curlyBracesWithJSs[n].trim())} }}`)}restorePhpBlock(e){return this.restoreRawPhpBlock(e).then(t=>this.restoreRawPropsBlock(t))}async restoreRawPhpBlock(e){return x(e,new RegExp(`${this.getRawPlaceholder("(\\d+)")}`,"gm"),async(t,n)=>{var d;let i=this.rawBlocks[n],s=this.getRawPlaceholder(n.toString()),a=(d=e.match(new RegExp(`^(.*?)${s}`,"gmi")))!=null?d:[""],l=b(a[0]),o=this.isInline(i),c=await this.isMultilineStatement(i);if(o&&c)i=(await D(`<?php
${i}
?>`,this.options)).trim();else if(c){let p=l.amount+this.indentSize;i=(await D(`<?php${i}?>`,{...this.options,useProjectPrintWidth:!0,adjustPrintWidthBy:p})).trimEnd()}else o?i=`<?php${i}?>`:i=(await D(`<?php${i}?>`,this.options)).trimEnd();return r.replace(i,/^(\s*)?<\?php(.*?)\?>/gms,(p,u,m)=>{if(this.isInline(i))return`@php${m}@endphp`;let w=this.preserveStringLiteralInPhp(m);w=this.preservePhpComment(w);let _=this.indentRawBlock(l,w);return _=this.restorePhpComment(_),`@php${this.restoreStringLiteralInPhp(_)}@endphp`})})}async restoreRawPropsBlock(e){let t=this.getRawPropsPlaceholder("(\\d+)");return x(e,new RegExp(t,"gms"),async(n,i)=>{var c;let s=this.getRawPropsPlaceholder(i.toString()),a=(c=e.match(new RegExp(`^(.*?)${s}`,"gmi")))!=null?c:[""],l=b(a[0]),o=`@props(${(await C(this.rawPropsBlocks[i],{...this.options})).trim()})`;return this.indentRawPhpBlock(l,o)})}isInline(e){return r.split(e,`
`).length===1}async isMultilineStatement(e){return(await D(`<?php${e}?>`,this.options)).trimRight().split(`
`).length>1}indentRawBlock(e,t){if(this.isInline(t))return`${e.indent}${t}`;let i=e.amount/this.indentSize,s=this.indentCharacter.repeat(i<0?0:(i+1)*this.indentSize),a=this.indentCharacter.repeat(i<0?0:i*this.indentSize),l=t.split(`
`);return r.chain(l).map((o,c)=>c===0?o.trim():c===l.length-1?a+o:o.length===0?o:s+o).join(`
`).value()}indentBladeDirectiveBlock(e,t){if(r.isEmpty(e.indent))return t;if(this.isInline(t))return`${e.indent}${t}`;let i=e.amount/this.indentSize,s=this.indentCharacter.repeat(i<0?0:i*this.indentSize),a=this.indentCharacter.repeat(i<0?0:i*this.indentSize),l=t.split(`
`);return r.chain(l).map((o,c)=>c===l.length-1?a+o:s+o).value().join(`
`)}indentScriptBlock(e,t){if(r.isEmpty(e.indent))return t;if(this.isInline(t))return`${t}`;let i=e.amount/this.indentSize,s=this.indentCharacter.repeat(i<0?0:i*this.indentSize),a=this.indentCharacter.repeat(i<0?0:i*this.indentSize),o=r.replace(t,/`.*?`/gs,d=>this.storeTemplatingString(d)).split(`
`),c=r.chain(o).map((d,p)=>p===0?d:p===o.length-1?a+d:r.isEmpty(d)?d:s+d).value().join(`
`);return this.restoreTemplatingString(`${c}`)}indentRawPhpBlock(e,t){if(r.isEmpty(e.indent))return t;if(this.isInline(t))return`${t}`;let i=e.amount/this.indentSize,s=this.indentCharacter.repeat(i<0?0:i*this.indentSize),a=t.split(`
`);return r.chain(a).map((l,o)=>o===0?l.trim():s+l).value().join(`
`)}indentComponentAttribute(e,t){if(r.isEmpty(e))return t;if(this.isInline(t))return`${t}`;if(this.isInline(t)&&/\S/.test(e))return`${t}`;let i=b(e).amount/this.indentSize,s=this.indentCharacter.repeat(i<0?0:i*this.indentSize),a=t.split(`
`);return r.chain(a).map((l,o)=>o===0?l.trim():s+l).value().join(`
`)}indentPhpComment(e,t){if(r.isEmpty(e.indent))return t;if(this.isInline(t))return`${t}`;let i=e.amount/this.indentSize,s=this.indentCharacter.repeat(i<0?0:i*this.indentSize),a=t.split(`
`),l=!1;return r.chain(a).map((o,c)=>c===0?o.trim():o.trim().startsWith("*")?o.trim().endsWith("*/")&&l?o:s+o:(l=!0,o)).join(`
`).value()}restoreBladeDirectivesInStyles(e){return r.replace(e,/(?<=<style[^>]*?(?<!=)>)(.*?)(?=<\/style>)/gis,t=>{let n=t,i=new RegExp(`${this.getBladeDirectiveInStylePlaceholder("(\\d+)")} {\\s*?/\\* inline_directive \\*/\\s*?}`,"gmi");n=r.replace(n,i,(o,c)=>this.bladeDirectivesInStyle[c]);let s=new RegExp(`}\\s*?${this.getBladeDirectiveInStylePlaceholder("(\\d+)")} {\\s*?/\\*else\\*/`,"gmi");n=r.replace(n,s,(o,c)=>`${this.bladeDirectivesInStyle[c]}`);let a=new RegExp(`${this.getBladeDirectiveInStylePlaceholder("(\\d+)")} {\\s*?/\\*start\\*/`,"gmi");n=r.replace(n,a,(o,c)=>`${this.bladeDirectivesInStyle[c]}`);let l=new RegExp(`}\\s*?/\\* ${this.getBladeDirectiveInStylePlaceholder("(\\d+)")} \\*/`,"gmi");return n=r.replace(n,l,(o,c)=>`${this.bladeDirectivesInStyle[c]}`),n})}async restoreBladeDirectivesInScripts(e){let t=new RegExp(`${this.getBladeDirectivePlaceholder("(\\d+)")}`,"gm"),n=r.replace(e,t,(i,s)=>{var c;let a=this.getBladeDirectivePlaceholder(s.toString()),l=(c=e.match(new RegExp(`^(.*?)${a}`,"gmi")))!=null?c:[""],o=b(l[0]);return this.indentBladeDirectiveBlock(o,this.bladeDirectives[s])});return n=await x(n,/(?<=<script[^>]*?(?<!=)>)(.*?)(?=<\/script>)/gis,async i=>{let s=i;return s=r.replace(s,new RegExp(`if \\( \\/\\*(?:(?:${this.getBladeDirectiveInScriptPlaceholder("(\\d+)")}).*?)\\*\\/ \\) \\{`,"gis"),(a,l)=>`${this.directivesInScript[l]}`),s=r.replace(s,new RegExp(`} \\/\\* (?:${this.getBladeDirectiveInScriptPlaceholder("(\\d+)")}) \\*\\/ {(\\s*?\\(___directive_condition_\\d+___\\))?`,"gim"),(a,l,o)=>r.isUndefined(o)?`${this.directivesInScript[l].trim()}`:`${this.directivesInScript[l].trim()} ${(o!=null?o:"").trim()}`),s=r.replace(s,new RegExp(`} \\/\\*(?:${this.getBladeDirectiveInScriptPlaceholder("(\\d+)")})\\*\\/`,"gis"),(a,l)=>`${this.directivesInScript[l]}`),s=await x(s,new RegExp(`${this.getRawPlaceholder("(\\d+)")}`,"gm"),async(a,l)=>{var u;let o=this.rawBlocks[l],c=this.getRawPlaceholder(l.toString()),d=(u=e.match(new RegExp(`^(.*?)${c}`,"gmi")))!=null?u:[""],p=b(d[0]);return this.isInline(o)&&await this.isMultilineStatement(o)?o=(await D(`<?php
${o}
?>`,this.options)).trim():o.split(`
`).length>1?o=(await D(`<?php${o}?>`,this.options)).trim():o=`<?php${o}?>`,r.replace(o,/^(\s*)?<\?php(.*?)\?>/gms,(m,w,_)=>{if(this.isInline(o))return`@php${_}@endphp`;let B=this.preserveStringLiteralInPhp(_),Ae=this.indentRawBlock(p,B);return`@php${this.restoreStringLiteralInPhp(Ae)}@endphp`})}),s=r.replace(s,/(?<=[\S]+)(\s*?)\/\*\*\*script_placeholder\*\*\*\/(\s)?/gim,(a,l,o)=>{if(o!==void 0)return o;let c=l!=null?l:"",d=o!=null?o:"";return c+d}),s}),t.test(n)&&(n=await this.restoreBladeDirectivesInScripts(n)),n}async formatPreservedBladeDirectives(e){return qe.map(e,async t=>{let n=await this.formatAsHtml(t);return(await this.formatAsBlade(n)).trimRight(`
`)})}restoreBladeComment(e){return new Promise(t=>t(e)).then(t=>r.replace(t,new RegExp(`${this.getBladeCommentPlaceholder("(\\d+)")}`,"gms"),(n,i)=>this.bladeComments[i].replace(/{{--(?=\S)/g,"{{-- ").replace(/(?<=\S)--}}/g," --}}")))}restoreXslot(e){return r.replace(e,/x-slot\s*--___(\d+)___--/gms,(t,n)=>this.xSlot[n]).replace(/(?<=<x-slot:[\w\_\-]*)\s+(?=\/?>)/gm,()=>"")}restorePhpComment(e){return r.replace(e,new RegExp(`${this.getPhpCommentPlaceholder("(\\d+)")};{0,1}`,"gms"),(t,n)=>{var o;let i=this.getPhpCommentPlaceholder(n.toString()),s=(o=e.match(new RegExp(`^(.*?)${i}`,"gmi")))!=null?o:[""],a=b(s[0]),l=he(this.phpComments[n]);return this.indentPhpComment(a,l)})}async restoreEscapedBladeDirective(e){return new Promise(t=>t(e)).then(t=>r.replace(t,new RegExp(`${this.getEscapedBladeDirectivePlaceholder("(\\d+)")}`,"gms"),(n,i)=>this.escapedBladeDirectives[i]))}async restoreBladeBrace(e){return new Promise(t=>t(e)).then(t=>x(t,new RegExp(`${this.getBladeBracePlaceholder("(\\d+)")}`,"gm"),async(n,i)=>{var c;let s=this.getBladeBracePlaceholder(i.toString()),a=(c=e.match(new RegExp(`^(.*?)${s}`,"gmi")))!=null?c:[""],l=b(a[0]),o=this.bladeBraces[i];return o.trim()===""?`{{${o}}}`:this.isInline(o)?`{{ ${(await C(o,{...this.options,trailingCommaPHP:!1,printWidth:A})).replace(/([\n\s]*)->([\n\s]*)/gs,"->").split(`
`).map(d=>d.trim()).join("").trimRight(`
`)} }}`:`{{ ${this.indentRawPhpBlock(l,(await C(o,this.options)).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim().trimEnd())} }}`}))}async restoreRawBladeBrace(e){return new Promise(t=>t(e)).then(t=>x(t,new RegExp(`${this.getRawBladeBracePlaceholder("(\\d+)")}`,"gms"),async(n,i)=>{var c;let s=this.getRawBladeBracePlaceholder(i),a=(c=e.match(new RegExp(`^(.*?)${s}`,"gmi")))!=null?c:[""],l=b(a[0]),o=this.rawBladeBraces[i];return o.trim()===""?`{!!${o}!!}`:this.indentRawPhpBlock(l,`{!! ${(await C(o,this.options)).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim()} !!}`)}))}restoreInlineDirective(e){return new Promise(t=>t(e)).then(t=>r.replace(t,new RegExp(`${this.getInlinePlaceholder("(\\d+)")}`,"gms"),(n,i)=>this.inlineDirectives[i]))}async restoreConditions(e){return new Promise(t=>t(e)).then(t=>x(t,new RegExp(`${this.getConditionPlaceholder("(\\d+)")}`,"gms"),async(n,i)=>{var c;let s=this.getConditionPlaceholder(i),a=(c=e.match(new RegExp(`^(.*?)${s}`,"gmi")))!=null?c:[""],l=b(a[0]),o=this.conditions[i];return this.formatExpressionInsideBladeDirective(o,l)}))}restoreUnbalancedDirective(e){return new Promise(t=>t(e)).then(t=>r.replace(t,/@if \(unbalanced___(\d+)___\)/gms,(n,i)=>this.unbalancedDirectives[i]))}async restoreInlinePhpDirective(e){return new Promise(t=>t(e)).then(t=>x(t,new RegExp(`${this.getInlinePhpPlaceholder("(\\d+)")}`,"gm"),async(n,i)=>{var c;let s=this.inlinePhpDirectives[i],a=this.getInlinePhpPlaceholder(i),l=(c=e.match(new RegExp(`^(.*?)${a}`,"gmi")))!=null?c:[""],o=b(l[0]);return s.includes("@php")?`${(await C(s,{...this.options,printWidth:A})).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim().trimRight(`
`)}`:new RegExp(ne.join("|"),"gi").test(s)?x(s,new RegExp(`(?<=@(${r.map(ne,p=>p.substring(1)).join("|")}).*?\\()(.*)(?=\\))`,"gis"),async(p,u,m)=>{let w=this.wrapLineLength;return["button","class"].includes(u)&&(w=80),u==="include"&&(w=this.wrapLineLength-4-i.length-o.amount),this.formatExpressionInsideBladeDirective(m,o,w)}):`${(await C(s,{...this.options,printWidth:A})).trimEnd()}`}))}async restoreRawPhpTags(e){return new Promise(t=>t(e)).then(t=>x(t,new RegExp(`${this.getRawPhpTagPlaceholder("(\\d+)")}`,"gms"),async(n,i)=>{var s;try{let a=this.rawPhpTags[i],o=/(?<=<\?php\s*?)\/\*.*?\*\/(?=\s*?\?>)/gim.test(a)&&this.isInline(a),c=this.getRawPhpTagPlaceholder(i),d=(s=e.match(new RegExp(`^(.*?)${c}`,"gmi")))!=null?s:[""],p=b(d[0]);if(o)return a;let u=(await D(this.rawPhpTags[i],this.options)).trim().trimEnd();if(this.isInline(u))return u;let m=this.preservePhpComment(u);return p.indent&&(m=this.indentRawPhpBlock(p,m)),this.restorePhpComment(m)}catch{return`${this.rawPhpTags[i]}`}}))}restoreNonnativeScripts(e){return r.replace(e,new RegExp(`${this.getNonnativeScriptPlaceholder("(\\d+)")}`,"gmi"),(t,n)=>`${this.nonnativeScripts[n]}`)}restoreScripts(e){return new Promise(t=>t(e)).then(t=>r.replace(t,new RegExp(`${this.getScriptPlaceholder("(\\d+)")}`,"gim"),(n,i)=>{var p;let s=this.scripts[i],a=this.getScriptPlaceholder(i),l=(p=e.match(new RegExp(`^(.*?)${a}`,"gmi")))!=null?p:[""],o=b(l[0]),c=f(this.options).useTabs||!1,d={indent_size:f(this.options).indentSize||4,wrap_line_length:f(this.options).wrapLineLength||120,wrap_attributes:f(this.options).wrapAttributes||"auto",wrap_attributes_min_attrs:f(this.options).wrapAttributesMinAttrs,indent_inner_html:f(this.options).indentInnerHtml||!1,extra_liners:f(this.options).extraLiners,indent_with_tabs:c,end_with_newline:!1,templating:["php"]};return c?this.indentScriptBlock(o,r.replace(L.html_beautify(s,d),/\t/g,"	".repeat(this.indentSize))):this.indentScriptBlock(o,L.html_beautify(s,d))}))}async restoreCustomDirective(e){return this.restoreInlineCustomDirective(e).then(t=>this.restoreBeginCustomDirective(t)).then(t=>this.restoreElseCustomDirective(t)).then(t=>this.restoreEndCustomDirective(t))}async restoreInlineCustomDirective(e){return x(e,new RegExp(`${this.getInlineCustomDirectivePlaceholder("(\\d+)")}`,"gim"),async(t,n)=>{var o;let i=this.getInlineCustomDirectivePlaceholder(n.toString()),s=(o=e.match(new RegExp(`^(.*?)${r.escapeRegExp(i)}`,"gmi")))!=null?o:[""],a=b(s[0]),l=`${this.customDirectives[n]}`;return x(l,/(@[a-zA-z0-9\-_]+)(.*)/gis,async(c,d,p)=>{try{let u=(await C(`func${p}`,{...this.options,printWidth:A})).replace(/([\n\s]*)->([\n\s]*)/gs,"->").replace(/,(\s*?\))$/gm,(m,w)=>w).trim().substring(4);return`${d}${this.indentComponentAttribute(a.indent,u)}`}catch{return`${c}`}})})}async restoreBeginCustomDirective(e){return x(e,new RegExp(`@customdirective\\(___(\\d+)___\\)\\s*?(${y})*`,"gim"),async(t,n)=>{var o;let i=this.getBeginCustomDirectivePlaceholder(n.toString()),s=(o=e.match(new RegExp(`^(.*?)${r.escapeRegExp(i)}`,"gmi")))!=null?o:[""],a=b(s[0]),l=`${this.customDirectives[n]}`;return x(l,/(@[a-zA-z0-9\-_]+)(.*)/gis,async(c,d,p)=>{try{let u=(await C(`func${p}`,{...this.options,trailingCommaPHP:!1})).replace(/([\n\s]*)->([\n\s]*)/gs,"->").trim().substring(4);return`${d}${this.indentComponentAttribute(a.indent,u)}`}catch{return`${c}`}})})}async restoreElseCustomDirective(e){return r.replace(e,/@else\(___(\d+)___\)/gim,(t,n)=>`${this.customDirectives[n]}`)}async restoreEndCustomDirective(e){return r.replace(e,/@endcustomdirective\(___(\d+)___\)/gim,(t,n)=>`${this.customDirectives[n]}`)}async restoreHtmlTags(e){return r.replace(e,new RegExp(`${this.getHtmlTagPlaceholder("(\\d+)")}`,"gim"),(t,n)=>{var p;let i=this.getHtmlTagPlaceholder(n.toString()),s=(p=e.match(new RegExp(`^(.*?)${i}`,"gmi")))!=null?p:[""],a=b(s[0]),l={indent_size:f(this.options).indentSize||4,wrap_line_length:f(this.options).wrapLineLength||120,wrap_attributes:f(this.options).wrapAttributes||"auto",wrap_attributes_min_attrs:f(this.options).wrapAttributesMinAttrs,indent_inner_html:f(this.options).indentInnerHtml||!1,extra_liners:f(this.options).extraLiners,end_with_newline:!1,templating:["php"]},o=this.htmlTags[n],c=r.first(o.match(/(<(textarea|pre).*?(?<!=)>)(?=.*?<\/\2>)/gis));if(c===void 0)return`${this.indentScriptBlock(a,L.html_beautify(o,l))}`;let d=o.substring(c.length,o.length);return`${this.indentScriptBlock(a,L.html_beautify(c,l))}${d}`})}restoreHtmlAttributes(e){return r.replace(e,new RegExp(`${this.getHtmlAttributePlaceholder("(\\d+)")}`,"gms"),(t,n)=>this.htmlAttributes[n])}restoreXData(e){return r.replace(e,new RegExp(`${this.getXDataPlaceholder("(\\d+)")}`,"gm"),(t,n)=>{var u;let i=this.getXDataPlaceholder(n.toString()),s=(u=e.match(new RegExp(`^(.*?)${i}`,"gmi")))!=null?u:[""],a=b(s[0]),l=this.formatJS(this.xData[n]).split(`
`),o=a.amount/(this.indentCharacter==="	"?4:1),c=l[0],d=this.indentCharacter.repeat(o<0?0:o),p=l.map(m=>d+m);return p[0]=c,`${p.join(`
`)}`})}restoreXInit(e){return r.replace(e,new RegExp(`${this.getXInitPlaceholder("(\\d+)")}`,"gm"),(t,n)=>{var u;let i=this.getXInitPlaceholder(n.toString()),s=(u=e.match(new RegExp(`^(.*?)${i}`,"gmi")))!=null?u:[""],a=b(s[0]),l=this.formatJS(this.xInit[n]).split(`
`),o=a.amount/(this.indentCharacter==="	"?4:1),c=l[0],d=this.indentCharacter.repeat(o<0?0:o),p=l.map(m=>d+m);return p[0]=c,`${p.join(`
`)}`})}restoreTemplatingString(e){return r.replace(e,new RegExp(`${this.getTemplatingStringPlaceholder("(\\d+)")}`,"gms"),(t,n)=>this.templatingStrings[n])}restoreStringLiteralInPhp(e){return r.replace(e,new RegExp(`${this.getStringLiteralInPhpPlaceholder("(\\d+)")}`,"gms"),(t,n)=>this.stringLiteralInPhp[n])}async restoreComponentAttribute(e){return x(e,new RegExp(`${this.getComponentAttributePlaceholder("(\\d+)")}`,"gim"),async(t,n)=>{var c;let i=this.getComponentAttributePlaceholder(n),s=(c=e.match(new RegExp(`^(.*?)${i}`,"gmi")))!=null?c:[""],a=b(s[0]),l=this.componentAttributes[n],o=await x(l,/(:{1,2}.*?=)(["'])(.*?)(?=\2)/gis,async(d,p,u,m)=>{if(m==="")return d;if(s[0].startsWith("<livewire"))return`${p}${u}${m}`;if(p.startsWith("::"))return`${p}${u}${L.js_beautify(m,{wrap_line_length:this.wrapLineLength-a.amount,brace_style:"preserve-inline"}).trim()}`;if(this.isInline(m))try{return`${p}${u}${(await C(m,{...this.options,printWidth:this.wrapLineLength-a.amount})).trimEnd()}`}catch{return`${p}${u}${m}`}return`${p}${u}${(await C(m,{...this.options,printWidth:this.wrapLineLength-a.amount})).trimEnd()}`});return`${this.indentComponentAttribute(a.indent,o)}`})}restoreShorthandBinding(e){return r.replace(e,new RegExp(`${this.getShorthandBindingPlaceholder("(\\d+)")}`,"gms"),(t,n)=>{var c;let i=this.getShorthandBindingPlaceholder(n),s=(c=e.match(new RegExp(`^(.*?)${i}`,"gmi")))!=null?c:[""],a=b(s[0]),l=this.shorthandBindings[n],o=r.replace(l,/(:{1,2}.*?=)(["'])(.*?)(?=\2)/gis,(d,p,u,m)=>{let w={wrap_line_length:this.wrapLineLength-a.amount,brace_style:"preserve-inline"};if(m==="")return d;if(this.isInline(m))try{return`${p}${u}${L.js_beautify(m.trim(),w).trim()}`}catch{return`${p}${u}${m.trim()}`}return`${p}${u}${L.js_beautify(m.trim(),w).trim()}`});return`${this.indentComponentAttribute(a.indent,o)}`})}async formatAsBlade(e){this.currentIndentLevel=0,this.shouldBeIndent=!1;let t=W(e),n=await new G(this.vsctm,this.oniguruma);return n.createRegistry().loadGrammar("text.html.php.blade").then(a=>n.tokenizeLines(t,a)).then(a=>this.formatTokenizedLines(t,a)).catch(a=>{throw a})}async formatTokenizedLines(e,t){this.result=[],this.stack=[];for(let n=0;n<e.length;n+=1){let i=e[n],s=t[n];await this.processLine(s,i)}return this.result.join(this.endOfLine)}async processLine(e,t){await this.processTokenizeResult(e,t)}async processKeyword(e){if(r.includes(F,e)){r.last(this.stack)==="@case"&&e==="@case"&&this.decrementIndentLevel(),e==="@case"&&(this.shouldBeIndent=!0),this.stack.push(e);return}if(r.includes(U,e)){if(e==="@break"){this.decrementIndentLevel(),this.stack.pop(),this.stack.push(e);return}if(r.last(this.stack)!=="@hassection"){this.stack.pop();return}}if(r.includes(ue,e)&&(this.shouldBeIndent=!0,this.stack.push(e)),r.includes(te,e)&&r.includes(de,r.last(this.stack))&&(this.decrementIndentLevel(),this.shouldBeIndent=!0),r.includes(P,e)&&(r.last(this.stack)==="@section"&&e==="@section"?(this.currentIndentLevel>0&&this.decrementIndentLevel(),this.shouldBeIndent=!0,this.stack.push(e)):(this.shouldBeIndent=!0,this.stack.push(e))),r.includes(R,e)){if(e==="@endswitch"&&r.last(this.stack)==="@default"){this.decrementIndentLevel(2),this.shouldBeIndent=!1;return}this.decrementIndentLevel(),this.shouldBeIndent=!1,this.stack.pop()}r.includes(E,e)&&(this.decrementIndentLevel(),this.shouldBeIndent=!0)}async processToken(e,t){if(r.includes(e.scopes,"punctuation.definition.comment.begin.blade")&&(this.isInsideCommentBlock=!0),this.argumentCheck){let{count:n,inString:i,stack:s,unindentOn:a}=this.argumentCheck;if(!i&&t===")"){if(s.push(t),n[t]+=1,n["("]===n[t]){let l=s.join("");await _e(l)>=a&&(this.shouldBeIndent=!1),this.argumentCheck=!1}return}s.push(t),i===t?this.argumentCheck.inString=!1:!i&&(t==='"'||t==="'")&&(this.argumentCheck.inString=t),t==="("&&!i&&(n[t]+=1)}r.includes(e.scopes,"punctuation.definition.comment.end.blade")&&(this.isInsideCommentBlock=!1),(t==="{{--"||t.includes("{{--"))&&(this.isInsideCommentBlock=!0),(t==="--}}"||t.includes("--}}"))&&(this.isInsideCommentBlock=!1),r.includes(e.scopes,"keyword.blade")&&(this.isInsideCommentBlock||(await this.processKeyword(t.toLowerCase()),r.includes(Object.keys(ee),t.toLowerCase())&&(this.argumentCheck={unindentOn:ee[t.toLowerCase()],stack:[],inString:!1,count:{"(":0,")":0}})))}async processTokenizeResult(e,t){if(this.shouldBeIndent&&(this.incrementIndentLevel(),this.shouldBeIndent=!1),ge(e,t)){this.insertFormattedLineToResult(t);return}for(let n=0;n<e.tokens.length;n+=1){let i=e.tokens[n],s=t.substring(i.startIndex,i.endIndex).trim();await this.processToken(i,s)}this.insertFormattedLineToResult(t)}insertFormattedLineToResult(e){let n=b(e).amount+this.indentSize*this.currentIndentLevel,i=this.indentCharacter.repeat(n<0?0:n)+e.trim();e.length===0&&this.result.push(e),e.length!==0&&i.length>0&&this.result.push(i),i!==e&&this.diffs.push({original:e,formatted:i})}incrementIndentLevel(e=1){this.currentIndentLevel+=e}decrementIndentLevel(e=1){this.currentIndentLevel-=e}async formatExpressionInsideBladeDirective(e,t,n=void 0){let i=`func(${e})`,s=await C(i,{...this.options,printWidth:n!=null?n:this.defaultPhpFormatOption.printWidth});if(s===i)return e;let a=s.replace(/([\n\s]*)->([\n\s]*)/gs,"->").replace(/(?<!(['"]).*)(?<=\()[\n\s]+?(?=\w)/gm,"").replace(/([^]*)],[\n\s]*?\)$/gm,(l,o)=>`${o}]
)`).replace(/,[\n\s]*?\)/gs,")").replace(/,(\s*?\))$/gm,(l,o)=>o).trim();return this.options.useTabs&&(a=r.replace(a,/(?<=^ *) {4}/gm,"	".repeat(this.indentSize))),a=a.replace(/func\((.*)\)/gis,(l,o)=>o),this.isInline(a.trim())&&(a=a.trim()),this.indentRawPhpBlock(t,a)}formatJS(e){let t=e,n={js:[],entangle:[]};return Object.keys(n).forEach(i=>{t=t.replace(new RegExp(`@${i}\\((?:[^)(]+|\\((?:[^)(]+|\\([^)(]*\\))*\\))*\\)`,"gs"),s=>{let a=n[i].push(s)-1;return this.getPlaceholder(i,a,s.length)})}),t=L.js_beautify(t,{brace_style:"preserve-inline"}),Object.keys(n).forEach(i=>{t=t.replace(new RegExp(this.getPlaceholder(i,"_*(\\d+)"),"gms"),(s,a)=>n[i][a])}),t}};import Ze from"ajv";import Ye from"find-config";import et from"fs";import tt from"path";var nt=new Ze,Ie=[".bladeformatterrc.json",".bladeformatterrc"];function Re(h){for(let e=0;e<Ie.length;e+=1){let t=Ye(Ie[e],{cwd:tt.dirname(h),home:!1});if(t)return t}return null}async function Ee(h){if(h===null)return;let e=JSON.parse((await et.promises.readFile(h)).toString()),t={type:"object",properties:{indentSize:{type:"integer",nullable:!0},wrapLineLength:{type:"integer",nullable:!0},wrapAttributes:{type:"string",enum:["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"],nullable:!0},wrapAttributesMinAttrs:{type:"integer",nullable:!0,default:2},indentInnerHtml:{type:"boolean",nullable:!0},endWithNewline:{type:"boolean",nullable:!0},endOfLine:{type:"string",enum:["LF","CRLF"],nullable:!0},useTabs:{type:"boolean",nullable:!0},sortTailwindcssClasses:{type:"boolean",nullable:!0},tailwindcssConfigPath:{type:"string",nullable:!0},sortHtmlAttributes:{type:"string",enum:["none","alphabetical","code-guide","idiomatic","vuejs","custom"],nullable:!0},customHtmlAttributesOrder:{type:"array",nullable:!0,items:{type:"string"},default:[]},noMultipleEmptyLines:{type:"boolean",nullable:!0},noPhpSyntaxCheck:{type:"boolean",nullable:!0},noSingleQuote:{type:"boolean",nullable:!0},noTrailingCommaPhp:{type:"boolean",nullable:!0},extraLiners:{type:"array",nullable:!0,items:{type:"string"},default:["head","body","/html"]}},additionalProperties:!0},n=nt.compile(t);if(!n(e))throw n;return e}var N=class h{constructor(e={},t=[]){var n;this.currentTargetPath=".",this.paths=t,this.options=e,this.targetFiles=[],this.errors=[],this.diffs=[],this.outputs=[],this.formattedFiles=[],this.ignoreFile="",this.fulFillFiles=[],this.targetFiles=[],this.runtimeConfigPath=(n=e.runtimeConfigPath)!=null?n:null,this.runtimeConfigCache={}}async format(e,t={}){this.options=this.options||t;let n=I.resolve(g.cwd(),"target");return await this.readIgnoreFile(n),await this.findTailwindConfig(n),await this.readRuntimeConfig(n),new j(this.options).formatContent(e).catch(i=>{throw new O(i)})}async formatFromCLI(){try{this.printPreamble(),await this.readIgnoreFile(g.cwd()),await this.processPaths(),this.printResults()}catch{}}fileExists(e){return z.promises.access(e,z.constants.F_OK).then(()=>!0).catch(()=>!1)}async readIgnoreFile(e){let t=".bladeignore",n,i=I.dirname(e);if(this.options.ignoreFilePath?n=this.options.ignoreFilePath:n=De(t,{cwd:i}),!!n)try{this.ignoreFile=(await z.promises.readFile(n)).toString()}catch{}}async findTailwindConfig(e){if(!this.options.sortTailwindcssClasses)return;let t="tailwind.config.js",n;if(this.options.tailwindcssConfigPath)if(this.runtimeConfigPath){let i=I.dirname(this.runtimeConfigPath);n=I.resolve(i,this.options.tailwindcssConfigPath)}else I.isAbsolute(this.options.tailwindcssConfigPath)?n=I.resolve(this.options.tailwindcssConfigPath):n=I.resolve(this.options.tailwindcssConfigPath);else{let i=I.dirname(e);n=De(t,{cwd:i})}n&&(this.options.tailwindcssConfigPath=n)}async readRuntimeConfig(e){var n,i;v.isEmpty(this.runtimeConfigCache)&&(this.options=v.merge(this.options,this.runtimeConfigCache));let t;if(this.options.runtimeConfigPath?t=this.options.runtimeConfigPath:t=Re(e),!v.isNull(t)){this.runtimeConfigPath=t;try{let s=await Ee(t);this.options=v.mergeWith(this.options,s,(a,l)=>v.isNil(l)?a:l),this.runtimeConfigCache=this.options,this.options.sortTailwindcssClasses&&await this.findTailwindConfig(e)}catch(s){s instanceof SyntaxError&&(g.stdout.write($.red.bold(`
Blade Formatter JSON Syntax Error: 

`)),g.stdout.write(Le.format(s)),g.exit(1)),g.stdout.write($.red.bold(`
Blade Formatter Config Error: ${I.basename(t)}

`)),g.stdout.write(`\`${s.errors[0].instancePath.replace("/","")}\` ${s.errors[0].message}

`),(n=s.errors[0].params)!=null&&n.allowedValues&&console.log((i=s.errors[0].params)==null?void 0:i.allowedValues),g.exit(1)}}}async processPaths(){await Promise.all(v.map(this.paths,async e=>this.processPath(e)))}async processPath(e){await h.globFiles(e).then(t=>v.map(t,n=>I.relative(".",n))).then(t=>this.filterFiles(t)).then(this.fulFillFiles).then(t=>this.formatFiles(t))}static globFiles(e){return new Promise((t,n)=>{rt(e,(i,s)=>i?n(i):t(s))})}async filterFiles(e){if(this.ignoreFile==="")return e;let t=/^\.\.*/,n=v.filter(e,a=>t.test(I.relative(".",a))),i=v.xor(e,n),s=it().add(this.ignoreFile).filter(i);return v.concat(n,s)}static fulFillFiles(e){return this.targetFiles.push(e),Promise.resolve(e)}async formatFiles(e){await Promise.all(v.map(e,async t=>this.formatFile(t)))}async formatFile(e){await this.findTailwindConfig(e),await this.readRuntimeConfig(e),await q(e).then(t=>Promise.resolve(t.toString("utf-8"))).then(t=>new j(this.options).formatContent(t)).then(t=>this.checkFormatted(e,t)).then(t=>this.writeToFile(e,t)).catch(t=>{this.handleError(e,t)})}async checkFormatted(e,t){this.printFormattedOutput(e,t);let n=z.readFileSync(e,"utf-8"),i=W(n),s=W(t),a=be(e,i,s);return this.diffs.push(a),this.outputs.push(t),a.length>0&&((this.options.progress||this.options.write)&&g.stdout.write($.green("F")),this.options.checkFormatted&&(g.stdout.write(`${e}
`),g.exitCode=1),this.formattedFiles.push(e)),a.length===0&&(this.options.progress||this.options.write)&&g.stdout.write($.green(".")),Promise.resolve(t)}printFormattedOutput(e,t){this.options.write||this.options.checkFormatted||(g.stdout.write(`${t}`),v.last(this.paths)===e||v.last(this.targetFiles)===e)||(this.paths.length>1||this.targetFiles.length>1)&&g.stdout.write(`
`)}writeToFile(e,t){this.options.write&&(this.options.checkFormatted||t.length===0||v.isNull(t)||v.isEmpty(t)||z.writeFile(e,t,n=>{n&&(g.stdout.write(`${$.red(n.message)}
`),g.exit(1))}))}handleError(e,t){(this.options.progress||this.options.write)&&g.stdout.write($.red("E")),g.exitCode=1,this.errors.push({path:e,message:t.message,error:t})}printPreamble(){this.options.checkFormatted&&g.stdout.write(`Check formatting... 
`)}async printResults(){this.printDescription(),this.printDifferences(),this.printFormattedFiles(),this.printErrors()}printDescription(){if(!this.options.write)return;let e=`

`;g.stdout.write(e),g.stdout.write($.bold.green(`Fixed: F
`)),g.stdout.write($.bold.red(`Errors: E
`)),g.stdout.write($.bold("Not Changed: ")+$.bold.green(`.
`))}printFormattedFiles(){if(this.formattedFiles.length===0){this.options.checkFormatted&&g.stdout.write($.bold(`
All matched files are formatted! 
`));return}if(!this.options.write){this.options.checkFormatted&&g.stdout.write(`
Above file(s) are formattable. Forgot to run formatter? Use ${$.bold("--write")} option to overwrite.
`);return}g.stdout.write($.bold(`
Formatted Files: 
`)),v.each(this.formattedFiles,e=>g.stdout.write(`${$.bold(e)}
`))}printDifferences(){if(this.options.diff){if(g.stdout.write($.bold(`
Differences: 

`)),v.filter(this.diffs,e=>e.length>0).length===0){g.stdout.write($(`No changes found. 

`));return}v.each(this.diffs,e=>we(e))}}printErrors(){v.isEmpty(this.errors)||(g.stdout.write($.red.bold(`
Errors: 

`)),v.each(this.errors,e=>g.stdout.write(`${Le.format(e)}
`)))}};async function pt(){let h=await ot(ht(process.argv)).usage(`${M.green(Z)} ${ce}
An opinionated blade template formatter for Laravel. 

 ${M.yellow("Usage:")} $0 [options] [file glob | ...]`).wrap(null).example('$0 "resources/views/**/*.blade.php" --write',"Format all files in views directory").option("check-formatted",{alias:"c",type:"boolean",description:"Only checks files are formatted or not",default:!1}).option("write",{alias:"w",type:"boolean",description:"Write to file",default:!1}).option("diff",{alias:"d",type:"boolean",description:"Show diffs",default:!1}).option("end-with-newline",{alias:"e",type:"boolean",description:"End output with newline",default:!0}).option("end-of-line",{type:"string",description:"End of line character(s). [LF|CRLF]",default:ct.EOL===`\r
`?"CRLF":"LF"}).option("indent-size",{alias:"i",type:"integer",description:"Indentation size",default:4}).option("wrap-line-length",{alias:"wrap",type:"integer",description:"The length of line wrap size",default:120}).option("wrap-attributes",{alias:"wrap-atts",type:"string",description:`The way to wrap attributes.
[auto|force|force-aligned|force-expand-multiline|aligned-multiple|preserve|preserve-aligned]`,default:"auto"}).option("wrap-attributes-min-attrs",{type:"integer",alias:"M",description:"Minimum number of html tag attributes for force wrap attribute options. Wrap the first attribute only if 'force-expand-multiline' is specified in wrap attributes",default:"2"}).option("indent-inner-html",{alias:"I",type:"boolean",description:"Indent <head> and <body> sections in html.",default:!1}).option("sort-tailwindcss-classes",{alias:"sort-classes",type:"boolean",description:"Sort tailwindcss classes",default:!1}).option("tailwindcss-config-path",{alias:["tailwindcssConfigPath"],type:"string",description:"Specify path of tailwind config",default:null}).option("sort-html-attributes",{alias:"sort-attributes",type:"string",choices:["none","alphabetical","code-guide","idiomatic","vuejs","custom"],description:"Sort HTML attributes.",default:"none",defaultDescription:"none"}).option("custom-html-attributes-order",{type:"string",description:"Comma separated custom HTML attributes order. To enable this you must specify sort html attributes option as `custom`. You can use regex for attribute names.",default:null}).option("no-single-quote",{type:"boolean",description:"Use double quotes instead of single quotes for php expression.",default:!1}).option("single-quote",{type:"boolean",description:"this is a workaround for combine strict && boolean option",hidden:!0,default:!0}).option("extra-liners",{alias:"E",type:"string",description:"Comma separated list of tags that should have an extra newline before them.",default:"head,body,/html",nullable:!0,coerce(i){return oe.flatten(oe.flatten([i]).map(s=>s.split(",")))}}).option("no-multiple-empty-lines",{type:"boolean",description:"Merge multiple blank lines into a single blank line",default:!1}).option("multiple-empty-lines",{type:"boolean",description:"this is a workaround for combine strict && boolean option",hidden:!0,default:!0}).option("no-php-syntax-check",{type:"boolean",description:"Disable PHP syntax checking",default:!1}).option("php-syntax-check",{type:"boolean",description:"this is a workaround for combine strict && boolean option",hidden:!0,default:!0}).option("no-trailing-comma-php",{type:"boolean",description:"If set to true, no trailing commas are printed for php expression.",default:!1}).option("trailing-comma-php",{type:"boolean",description:"this is a workaround for combine strict && boolean option",hidden:!0,default:!0}).option("progress",{alias:"p",type:"boolean",description:"Print progress",default:!1}).option("stdin",{type:"boolean",description:"Format code provided on <STDIN>",default:!1}).option("config",{alias:["runtimeConfigPath"],type:"string",description:"Use this configuration, overriding .bladeformatterrc config options if present",default:null}).option("ignore-path",{alias:["ignoreFilePath"],type:"string",description:"Specify path of ignore file",default:null}).help("h").alias("h","help").strictOptions().fail((i,s)=>{if(s)throw s;process.stdout.write(`${M.red("error: ")}${i}

`),process.stdout.write(`${M.yellow("Usage: ")} ${Z} [options] [file glob | ...]

`),process.stdout.write(`For more information try ${M.green("--help")}
`),process.exit(1)}).epilog(`Copyright Shuhei Hayashibara 2022
For more information, see https://github.com/shufo/blade-formatter`),e=await lt.readFile(X.resolve("vscode-oniguruma/release/onig.wasm"));await at(e.buffer);let t=oe.chain(h.argv).set("noMultipleEmptyLines",!h.argv.multipleEmptyLines).set("noPhpSyntaxCheck",!h.argv.phpSyntaxCheck).set("noSingleQuote",!h.argv.singleQuote).set("noTrailingCommaPhp",!h.argv.trailingCommaPhp).value();if(h.argv.stdin){await process.stdin.pipe(st({encoding:"string"},i=>new N(t).format(i).then(s=>{s!==void 0&&process.stdout.write(s)}).catch(s=>{process.stdout.write(`${s.toString()}
`),process.exit(1)})));return}if(h.argv._.length===0){h.showHelp();return}await new N(t,h.argv._).formatFromCLI()}export{pt as default};
//# sourceMappingURL=cli-bundle.js.map
